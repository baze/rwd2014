webshims.register("mediaelement-jaris",function(e,t,n,r,i,s){"use strict";var o=t.mediaelement,u=n.swfmini,a=Modernizr.audio&&Modernizr.video,f=u.hasFlashPlayerVersion("9.0.115"),l=0,c="ActiveXObject"in n&&a,h={paused:!0,ended:!1,currentSrc:"",duration:n.NaN,readyState:0,networkState:0,videoHeight:0,videoWidth:0,seeking:!1,error:null,buffered:{start:function(e){return e?(t.error("buffered index size error"),i):0},end:function(e){return e?(t.error("buffered index size error"),i):0},length:0}},p=Object.keys(h),d={currentTime:0,volume:1,muted:!1};Object.keys(d);var v=e.extend({isActive:"html5",activating:"html5",wasSwfReady:!1,_bufferedEnd:0,_bufferedStart:0,currentTime:0,_ppFlag:i,_calledMeta:!1,lastDuration:0},h,d),m=function(e){try{e.nodeName}catch(n){return null}var r=t.data(e,"mediaelement");return r&&"third"==r.isActive?r:null},g=function(t,n){n=e.Event(n),n.preventDefault(),e.event.trigger(n,i,t)},y=s.playerPath||t.cfg.basePath+"swf/"+(s.playerName||"JarisFLVPlayer.swf");t.extendUNDEFProp(s.params,{allowscriptaccess:"always",allowfullscreen:"true",wmode:"transparent",allowNetworking:"all"}),t.extendUNDEFProp(s.vars,{controltype:"1",jsapi:"1"}),t.extendUNDEFProp(s.attrs,{bgcolor:"#000000"});var b=function(e,t){3>e&&clearTimeout(t._canplaythroughTimer),e>=3&&3>t.readyState&&(t.readyState=e,g(t._elem,"canplay"),t.paused||g(t._elem,"playing"),clearTimeout(t._canplaythroughTimer),t._canplaythroughTimer=setTimeout(function(){b(4,t)},4e3)),e>=4&&4>t.readyState&&(t.readyState=e,g(t._elem,"canplaythrough")),t.readyState=e},w=function(t){t.seeking&&2>Math.abs(t.currentTime-t._lastSeektime)&&(t.seeking=!1,e(t._elem).triggerHandler("seeked"))};o.jarisEvent={};var E,S={onPlayPause:function(e,t,n){var r,i;if(null==n)try{r=t.api.api_get("isPlaying")}catch(s){}else r=n;r==t.paused&&(t.paused=!r,i=t.paused?"pause":"play",t._ppFlag=!0,g(t._elem,i),3>t.readyState&&b(3,t),t.paused||g(t._elem,"playing"))},onSeek:function(t,n){n._lastSeektime=t.seekTime,n.seeking=!0,e(n._elem).triggerHandler("seeking"),clearTimeout(n._seekedTimer),n._seekedTimer=setTimeout(function(){w(n),n.seeking=!1},300)},onConnectionFailed:function(){t.error("media error")},onNotBuffering:function(e,t){b(3,t)},onDataInitialized:function(e,t){var n,r=t.duration;t.duration=e.duration,r==t.duration||isNaN(t.duration)||t._calledMeta&&2>(n=Math.abs(t.lastDuration-t.duration))||(t.videoHeight=e.height,t.videoWidth=e.width,t.networkState||(t.networkState=2),1>t.readyState&&b(1,t),clearTimeout(t._durationChangeTimer),t._calledMeta&&t.duration?t._durationChangeTimer=setTimeout(function(){t.lastDuration=t.duration,g(t._elem,"durationchange")},n>50?0:n>9?9:99):(t.lastDuration=t.duration,t.duration&&g(t._elem,"durationchange"),t._calledMeta||g(t._elem,"loadedmetadata")),t._calledMeta=!0)},onBuffering:function(e,t){t.ended&&(t.ended=!1),b(1,t),g(t._elem,"waiting")},onTimeUpdate:function(e,t){t.ended&&(t.ended=!1),3>t.readyState&&(b(3,t),g(t._elem,"playing")),t.seeking&&w(t),g(t._elem,"timeupdate")},onProgress:function(t,n){if(n.ended&&(n.ended=!1),n.duration&&!isNaN(n.duration)){var r=t.loaded/t.total;r>.02&&.2>r?b(3,n):r>.2&&(r>.99&&(n.networkState=1),b(4,n)),n._bufferedEnd&&n._bufferedEnd>r&&(n._bufferedStart=n.currentTime||0),n._bufferedEnd=r,n.buffered.length=1,e.event.trigger("progress",i,n._elem,!0)}},onPlaybackFinished:function(e,t){4>t.readyState&&b(4,t),t.ended=!0,g(t._elem,"ended")},onVolumeChange:function(e,t){(t.volume!=e.volume||t.muted!=e.mute)&&(t.volume=e.volume,t.muted=e.mute,g(t._elem,"volumechange"))},ready:function(){var n=function(e){var t=!0;try{e.api.api_get("volume")}catch(n){t=!1}return t};return function(r,s){var o=0,u=function(){return o>9?(s.tryedReframeing=0,i):(o++,s.tryedReframeing++,n(s)?(s.wasSwfReady=!0,s.tryedReframeing=0,T(s),x(s)):6>s.tryedReframeing?3>s.tryedReframeing?(s.reframeTimer=setTimeout(u,9),s.shadowElem.css({overflow:"visible"}),setTimeout(function(){s.shadowElem.css({overflow:"hidden"})},1)):(s.shadowElem.css({overflow:"hidden"}),e(s._elem).mediaLoad()):(clearTimeout(s.reframeTimer),t.error("reframing error")),i)};s&&s.api&&(s.tryedReframeing||(s.tryedReframeing=0),clearTimeout(E),clearTimeout(s.reframeTimer),s.shadowElem.removeClass("flashblocker-assumed"),o?s.reframeTimer=setTimeout(u,9):u())}}()};S.onMute=S.onVolumeChange;var x=function(e){var n,r=e.actionQueue.length,i=0;if(r&&"third"==e.isActive)for(;e.actionQueue.length&&r>i;){i++,n=e.actionQueue.shift();try{e.api[n.fn].apply(e.api,n.args)}catch(s){t.warn(s)}}e.actionQueue.length&&(e.actionQueue=[])},T=function(t){t&&((t._ppFlag===i&&e.prop(t._elem,"autoplay")||!t.paused)&&setTimeout(function(){if("third"==t.isActive&&(t._ppFlag===i||!t.paused))try{e(t._elem).play(),t._ppFlag=!0}catch(n){}},1),t.muted&&e.prop(t._elem,"muted",!0),1!=t.volume&&e.prop(t._elem,"volume",t.volume))},N=e.noop;if(a){var C={play:1,playing:1},k=["play","pause","playing","canplay","progress","waiting","ended","loadedmetadata","durationchange","emptied"],L=k.map(function(e){return e+".webshimspolyfill"}).join(" "),A=function(n){var r=t.data(n.target,"mediaelement");if(r){var i=n.originalEvent&&n.originalEvent.type===n.type;i==("third"==r.activating)&&(n.stopImmediatePropagation(),C[n.type]&&(r.isActive!=r.activating?e(n.target).pause():i&&(e.prop(n.target,"pause")._supvalue||e.noop).apply(n.target)))}};N=function(n){e(n).off(L).on(L,A),k.forEach(function(e){t.moveToFirstEvent(n,e)})},N(r)}o.setActive=function(n,r,i){if(i||(i=t.data(n,"mediaelement")),i&&i.isActive!=r){"html5"!=r&&"third"!=r&&t.warn("wrong type for mediaelement activating: "+r);var s=t.data(n,"shadowData");i.activating=r,e(n).pause(),i.isActive=r,"third"==r?(s.shadowElement=s.shadowFocusElement=i.shadowElem[0],e(n).addClass("swf-api-active nonnative-api-active").hide().getShadowElement().show()):(e(n).removeClass("swf-api-active nonnative-api-active").show().getShadowElement().hide(),s.shadowElement=s.shadowFocusElement=!1),e(n).trigger("mediaelementapichange")}};var O=function(){var e=["_calledMeta","lastDuration","_bufferedEnd","_bufferedStart","_ppFlag","currentSrc","currentTime","duration","ended","networkState","paused","seeking","videoHeight","videoWidth"],t=e.length;return function(n){if(n){clearTimeout(n._seekedTimer);var r=t,i=n.networkState;for(b(0,n),clearTimeout(n._durationChangeTimer);--r>-1;)delete n[e[r]];n.actionQueue=[],n.buffered.length=0,i&&g(n._elem,"emptied")}}}(),M=function(){var t={},n=function(n){var i,s,o;return t[n.currentSrc]?i=t[n.currentSrc]:n.videoHeight&&n.videoWidth?(t[n.currentSrc]={width:n.videoWidth,height:n.videoHeight},i=t[n.currentSrc]):(s=e.attr(n._elem,"poster"))&&(i=t[s],i||(o=r.createElement("img"),o.onload=function(){t[s]={width:this.width,height:this.height},t[s].height&&t[s].width?_(n,e.prop(n._elem,"controls")):delete t[s]},o.src=s,o.complete&&o.onload())),i||{width:300,height:"video"==n._elemNodeName?150:50}};return function(t){var r,i,s=t.elemDimensions;return("auto"==s.width||"auto"==s.height)&&(s=e.extend({},t.elemDimensions),r=n(t),i=r.width/r.height,"auto"==s.width&&"auto"==s.height?s=r:"auto"==s.width?(t.shadowElem.css({height:s.height}),s.width=t.shadowElem.height()*i):(t.shadowElem.css({width:s.width}),s.height=t.shadowElem.width()/i)),s}}(),_=function(t,n){var r,i=t._elem,s=t.shadowElem;e(i)[n?"addClass":"removeClass"]("webshims-controls"),"third"==t.isActive&&("audio"!=t._elemNodeName||n?(t.elemDimensions={width:i.style.width||e.attr(i,"width")||e(i).width(),height:i.style.height||e.attr(i,"height")||e(i).height()},r=M(t),r.minWidth=i.style.minWidth,r.minHeight=i.style.minHeight,s.css(r)):s.css({width:0,height:0}))},D=function(){var t={"":1,auto:1};return function(n){var r=e.attr(n,"preload");return null==r||"none"==r||e.prop(n,"autoplay")?!1:(r=e.prop(n,"preload"),!!(t[r]||"metadata"==r&&e(n).is(".preload-in-doubt, video:not([poster])")))}}(),P={A:/&amp;/g,a:/&/g,e:/\=/g,q:/\?/g},H=function(e){return e.replace?e.replace(P.A,"%26").replace(P.a,"%26").replace(P.e,"%3D").replace(P.q,"%3F"):e};if("matchMedia"in n){var B=!1;try{B=n.matchMedia("only all").matches}catch(j){}B&&(o.sortMedia=function(e,t){try{e=!e.media||matchMedia(e.media).matches,t=!t.media||matchMedia(t.media).matches}catch(n){return 0}return e==t?0:e?-1:1})}o.createSWF=function(n,r,c){if(!f)return setTimeout(function(){e(n).mediaLoad()},1),i;1>l?l=1:l++,c||(c=t.data(n,"mediaelement")),(e.attr(n,"height")||e.attr(n,"width"))&&t.warn("width or height content attributes used. Webshims prefers the usage of CSS (computed styles or inline styles) to detect size of a video/audio. It's really more powerfull.");var h,p="audio/rtmp"==r.type||"video/rtmp"==r.type,d=e.extend({},s.vars,{poster:H(e.attr(n,"poster")&&e.prop(n,"poster")||""),source:H(r.streamId||r.srcProp),server:H(r.server||"")}),m=e(n).data("vars")||{},g=e.prop(n,"controls"),b="jarisplayer-"+t.getID(n),w=e.extend({},s.params,e(n).data("params")),x=n.nodeName.toLowerCase(),T=e.extend({},s.attrs,{name:b,id:b},e(n).data("attrs")),C=function(){"third"==c.isActive&&_(c,e.prop(n,"controls"))};c&&c.swfCreated?(o.setActive(n,"third",c),c.currentSrc=r.srcProp,c.shadowElem.html('<div id="'+b+'">'),c.api=!1,c.actionQueue=[],h=c.shadowElem,O(c)):(h=e('<div class="polyfill-'+x+' polyfill-mediaelement" id="wrapper-'+b+'"><div id="'+b+'"></div>').css({position:"relative",overflow:"hidden"}),c=t.data(n,"mediaelement",t.objectCreate(v,{actionQueue:{value:[]},shadowElem:{value:h},_elemNodeName:{value:x},_elem:{value:n},currentSrc:{value:r.srcProp},swfCreated:{value:!0},id:{value:b.replace(/-/g,"")},buffered:{value:{start:function(e){return e>=c.buffered.length?(t.error("buffered index size error"),i):0},end:function(e){return e>=c.buffered.length?(t.error("buffered index size error"),i):(c.duration-c._bufferedStart)*c._bufferedEnd+c._bufferedStart},length:0}}})),h.insertBefore(n),a&&e.extend(c,{volume:e.prop(n,"volume"),muted:e.prop(n,"muted"),paused:e.prop(n,"paused")}),t.addShadowDom(n,h),t.data(n,"mediaelement")||t.data(n,"mediaelement",c),N(n),o.setActive(n,"third",c),_(c,g),e(n).on({"updatemediaelementdimensions loadedmetadata emptied":C,remove:function(e){!e.originalEvent&&o.jarisEvent[c.id]&&o.jarisEvent[c.id].elem==n&&(delete o.jarisEvent[c.id],clearTimeout(E),clearTimeout(c.flashBlock))}}).onWSOff("updateshadowdom",C)),o.jarisEvent[c.id]&&o.jarisEvent[c.id].elem==n||(o.jarisEvent[c.id]=function(e){if("ready"==e.type){var t=function(){c.api&&(D(n)&&c.api.api_preload(),S.ready(e,c))};c.api?t():setTimeout(t,9)}else c.currentTime=e.position,c.api&&(!c._calledMeta&&isNaN(e.duration)&&c.duration!=e.duration&&isNaN(c.duration)&&S.onDataInitialized(e,c),c._ppFlag||"onPlayPause"==e.type||S.onPlayPause(e,c),S[e.type]&&S[e.type](e,c)),c.duration=e.duration},o.jarisEvent[c.id].elem=n),e.extend(d,{id:b,evtId:c.id,controls:""+g,autostart:"false",nodename:x},m),p?d.streamtype="rtmp":"audio/mpeg"==r.type||"audio/mp3"==r.type?(d.type="audio",d.streamtype="file"):"video/youtube"==r.type&&(d.streamtype="youtube"),s.changeSWF(d,n,r,c,"embed"),clearTimeout(c.flashBlock),u.embedSWF(y,b,"100%","100%","9.0.115",!1,d,w,T,function(r){if(r.success){var i=function(){(!r.ref.parentNode&&h[0].parentNode||"none"==r.ref.style.display)&&(h.addClass("flashblocker-assumed"),e(n).trigger("flashblocker"),t.warn("flashblocker assumed")),e(r.ref).css({minHeight:"2px",minWidth:"2px",display:"block"})};c.api=r.ref,g||e(r.ref).attr("tabindex","-1").css("outline","none"),c.flashBlock=setTimeout(i,99),E||(clearTimeout(E),E=setTimeout(function(){i();var n=e(r.ref);n[0].offsetWidth>1&&n[0].offsetHeight>1&&0===location.protocol.indexOf("file:")?t.error("Add your local development-directory to the local-trusted security sandbox:  http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html"):(2>n[0].offsetWidth||2>n[0].offsetHeight)&&t.warn("JS-SWF connection can't be established on hidden or unconnected flash objects"),n=null},8e3))}})};var F=function(e,t,n,r){return r=r||m(e),r?(r.api&&r.api[t]?r.api[t].apply(r.api,n||[]):(r.actionQueue.push({fn:t,args:n}),r.actionQueue.length>10&&setTimeout(function(){r.actionQueue.length>5&&r.actionQueue.shift()},99)),r):!1};if(["audio","video"].forEach(function(n){var r,i={},s=function(e){("audio"!=n||"videoHeight"!=e&&"videoWidth"!=e)&&(i[e]={get:function(){var t=m(this);return t?t[e]:a&&r[e].prop._supget?r[e].prop._supget.apply(this):v[e]},writeable:!1})},o=function(e,t){s(e),delete i[e].writeable,i[e].set=t};o("seeking"),o("volume",function(e){var n=m(this);if(n)e*=1,isNaN(e)||((0>e||e>1)&&t.error("volume greater or less than allowed "+e/100),F(this,"api_volume",[e],n),n.volume!=e&&(n.volume=e,g(n._elem,"volumechange")),n=null);else if(r.volume.prop._supset)return r.volume.prop._supset.apply(this,arguments)}),o("muted",function(e){var t=m(this);if(t)e=!!e,F(this,"api_muted",[e],t),t.muted!=e&&(t.muted=e,g(t._elem,"volumechange")),t=null;else if(r.muted.prop._supset)return r.muted.prop._supset.apply(this,arguments)}),o("currentTime",function(e){var t=m(this);if(t)e*=1,isNaN(e)||F(this,"api_seek",[e],t);else if(r.currentTime.prop._supset)return r.currentTime.prop._supset.apply(this,arguments)}),["play","pause"].forEach(function(e){i[e]={value:function(){var t=m(this);if(t)t.stopPlayPause&&clearTimeout(t.stopPlayPause),F(this,"play"==e?"api_play":"api_pause",[],t),t._ppFlag=!0,t.paused!=("play"!=e)&&(t.paused="play"!=e,g(t._elem,e));else if(r[e].prop._supvalue)return r[e].prop._supvalue.apply(this,arguments)}}}),p.forEach(s),t.onNodeNamesPropertyModify(n,"controls",function(t,r){var i=m(this);e(this)[r?"addClass":"removeClass"]("webshims-controls"),i&&("audio"==n&&_(i,r),F(this,"api_controls",[r],i))}),t.onNodeNamesPropertyModify(n,"preload",function(){var n,r,i;D(this)&&(n=m(this),n?F(this,"api_preload",[],n):!c||!this.paused||this.error||e.data(this,"mediaerror")||this.readyState||this.networkState||this.autoplay||!e(this).is(":not(.nonnative-api-active)")||(i=this,r=t.data(i,"mediaelementBase")||t.data(i,"mediaelementBase",{}),clearTimeout(r.loadTimer),r.loadTimer=setTimeout(function(){e(i).mediaLoad()},9)))}),r=t.defineNodeNameProperties(n,i,"prop"),Modernizr.mediaDefaultMuted||t.defineNodeNameProperties(n,{defaultMuted:{get:function(){return null!=e.attr(this,"muted")},set:function(t){t?e.attr(this,"muted",""):e(this).removeAttr("muted")}}},"prop")}),f&&e.cleanData){var I=e.cleanData,q={object:1,OBJECT:1};e.cleanData=function(e){var t,n;if(e&&(n=e.length)&&l)for(t=0;n>t;t++)if(q[e[t].nodeName]&&"api_pause"in e[t]){l--;try{e[t].api_pause()}catch(r){}}return I.apply(this,arguments)}}a?"media"in r.createElement("source")||t.reflectProperties("source",["media"]):(["poster","src"].forEach(function(e){t.defineNodeNamesProperty("src"==e?["audio","video","source"]:["video"],e,{reflect:!0,propType:"src"})}),t.defineNodeNamesProperty(["audio","video"],"preload",{reflect:!0,propType:"enumarated",defaultValue:"",limitedTo:["","auto","metadata","none"]}),t.reflectProperties("source",["type","media"]),["autoplay","controls"].forEach(function(e){t.defineNodeNamesBooleanProperty(["audio","video"],e)}),t.defineNodeNamesProperties(["audio","video"],{HAVE_CURRENT_DATA:{value:2},HAVE_ENOUGH_DATA:{value:4},HAVE_FUTURE_DATA:{value:3},HAVE_METADATA:{value:1},HAVE_NOTHING:{value:0},NETWORK_EMPTY:{value:0},NETWORK_IDLE:{value:1},NETWORK_LOADING:{value:2},NETWORK_NO_SOURCE:{value:3}},"prop"))});