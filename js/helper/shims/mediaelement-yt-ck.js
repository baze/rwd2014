webshims.register("mediaelement-yt",function(e,t,n,r,i){"use strict";var s=t.mediaelement,o=jQuery.Deferred();n.onYouTubePlayerAPIReady=function(){o.resolve()},n.YT&&YT.Player&&n.onYouTubePlayerAPIReady();var u={paused:!0,ended:!1,currentSrc:"",duration:n.NaN,readyState:0,networkState:0,videoHeight:0,videoWidth:0,error:null,buffered:{start:function(e){return e?(t.error("buffered index size error"),i):0},end:function(e){return e?(t.error("buffered index size error"),i):0},length:0}},a=Object.keys(u),f={currentTime:0,volume:1,muted:!1};Object.keys(f);var l=e.extend({isActive:"html5",activating:"html5",wasSwfReady:!1,_metadata:!1,_callMeta:!1,currentTime:0,_buffered:0,_ppFlag:i},u,f),c=function(t,n){n=e.Event(n),n.preventDefault(),e.event.trigger(n,i,t)},h=function(){var e=["_buffered","_metadata","_ppFlag","currentSrc","currentTime","duration","ended","networkState","paused","videoHeight","videoWidth","_callMeta"],t=e.length;return function(n){if(n){var r=t,i=n.networkState;for(n.readyState=0;--r;)delete n[e[r]];n.buffered.length=0,clearInterval(n._timeInterval),i&&c(n._elem,"emptied")}}}(),p=function(){var t={},n=function(n){var i,s,o;return t[n.currentSrc]?i=t[n.currentSrc]:n.videoHeight&&n.videoWidth?(t[n.currentSrc]={width:n.videoWidth,height:n.videoHeight},i=t[n.currentSrc]):(s=e.attr(n._elem,"poster"))&&(i=t[s],i||(o=r.createElement("img"),o.onload=function(){t[s]={width:this.width,height:this.height},t[s].height&&t[s].width?d(n):delete t[s]},o.src=s,o.complete&&o.onload())),i||{width:300,height:"video"==n._elemNodeName?150:50}};return function(t){var r,i,s=t.elemDimensions;return("auto"==s.width||"auto"==s.height)&&(s=e.extend({},t.elemDimensions),r=n(t),i=r.width/r.height,"auto"==s.width&&"auto"==s.height?s=r:"auto"==s.width?(t.shadowElem.css({height:s.height}),s.width=t.shadowElem.height()*i):(t.shadowElem.css({width:s.width}),s.height=t.shadowElem.width()/i)),s}}(),d=function(t){var r,i=t._elem,s=t.shadowElem;"third"==t.isActive&&(t&&t._ytAPI&&t._ytAPI.getPlaybackQuality&&(n.ytapi=t._ytAPI),t.elemDimensions={width:i.style.width||e.attr(i,"width")||e(i).width(),height:i.style.height||e.attr(i,"height")||e(i).height()},r=p(t),r.minWidth=i.style.minWidth,r.minHeight=i.style.minHeight,s.css(r))},v=function(e){try{e.nodeName}catch(n){return null}var r=t.data(e,"mediaelement");return r&&"third"==r.isActive?r:null},m=function(n){var r;return n=n.split("?"),-1!=n[0].indexOf("youtube.com/watch")&&n[1]?(n=n[1].split("&"),e.each(n,function(e,t){return t=t.split("="),"v"==t[0]?(n=t[1],r=!0,!1):i})):-1!=n[0].indexOf("youtube.com/v/")&&(n=n[0].split("/"),e.each(n,function(e,t){return r?(n=t,!1):("v"==t&&(r=!0),i)})),r||t.warn("no youtube id found: "+n),n},g=function(t){t&&(t._ppFlag===i&&e.prop(t._elem,"autoplay")||!t.paused)&&setTimeout(function(){if("third"==t.isActive&&(t._ppFlag===i||!t.paused))try{e(t._elem).play()}catch(n){}},1)},y=e.noop;(function(){var n={play:1,playing:1},i=["play","pause","playing","canplay","progress","waiting","ended","loadedmetadata","durationchange","emptied"],s=i.map(function(e){return e+".webshimspolyfill"}).join(" "),o=function(r){var i=t.data(r.target,"mediaelement");if(i){var s=r.originalEvent&&r.originalEvent.type===r.type;s==("third"==i.activating)&&(r.stopImmediatePropagation(),n[r.type]&&i.isActive!=i.activating&&e(r.target).pause())}};y=function(n){e(n).off(s).on(s,o),i.forEach(function(e){t.moveToFirstEvent(n,e)})},y(r)})(),e(r).on("emptied",function(e){var t=v(e.target);g(t)}),s.setActive=function(n,r,i){if(i||(i=t.data(n,"mediaelement")),i&&i.isActive!=r){"html5"!=r&&"third"!=r&&t.warn("wrong type for mediaelement activating: "+r);var s=t.data(n,"shadowData");i.activating=r,e(n).pause(),i.isActive=r,"third"==r?(s.shadowElement=s.shadowFocusElement=i.shadowElem[0],e(n).addClass("yt-api-active nonnative-api-active").hide().getShadowElement().show()):(clearInterval(i._timeInterval),e(n).removeClass("yt-api-active nonnative-api-active").show().getShadowElement().hide(),s.shadowElement=s.shadowFocusElement=!1),e(n).trigger("mediaelementapichange")}};var b=function(t,n){n._ppFlag=!0,"playing"==t&&(b("play",n),3>n.readyState&&(n.readyState=3,c(n._elem,"canplay")),e(n._elem).trigger("playing")),"play"==t&&n.paused?(n.paused=!1,c(n._elem,"play")):"pause"!=t||n.paused||(n.paused=!0,c(n._elem,"pause"))},w={small:{height:240,width:320},medium:{height:360,width:640},large:{height:480,width:853},hd720:{height:720,width:1280},hd1080:{height:1080,width:1920}},E=function(t,n,r,i){o.done(function(){var s=function(){var n,i;r._metadata&&r._ytAPI.getVideoLoadedFraction&&(i=r._ytAPI.getVideoLoadedFraction(),n=i*r.duration,r._buffered!==n&&(r._buffered=n,r.buffered.length=1,e(t).trigger("progress")),i>.99&&(r.networkState=1),4>r.readyState&&r.currentTime&&(r._buffered-r.currentTime>9||i>.9)&&(r.readyState=4,c(r._elem,"canplaythrough")))},o=function(){if(r._ytAPI&&r._ytAPI.getCurrentTime){var n=r._ytAPI.getCurrentTime();r.currentTime!=n&&(r.currentTime=n,e(t).trigger("timeupdate")),s()}},u=function(){if("third"==r.isActive&&r._ytAPI&&r._ytAPI.getVolume){var n,i=r._ytAPI.getVolume()/100,u=r._ytAPI.isMuted();i!=r.volume&&(r.volume=i,n=!0),u!=r.muted&&(r.muted=u,n=!0),o(),s(),n&&e(t).trigger("volumechange")}},a=function(){clearInterval(r._timeInterval),r._timeInterval=setInterval(function(){var n=r._ytAPI.getCurrentTime();r.currentTime!=n&&(r.currentTime=n,e(t).trigger("timeupdate"))},350)};r._ytAPI=new YT.Player(n,{height:"100%",width:"100%",allowfullscreen:"allowfullscreen",webkitallowfullscreen:"allowfullscreen",playerVars:{allowfullscreen:!0,fs:1,rel:0,showinfo:0,autohide:1,controls:e.prop(t,"controls")?1:0},videoId:i,events:{onReady:function(){g(r),setTimeout(u,9),setInterval(u,5e3)},onStateChange:function(n){if(n.target.getDuration){var i;if(!r._metadata){var s=n.target.getDuration(),o=n.target.getPlaybackQuality();s&&(r._metadata=!0,r.duration=s,1>r.readyState&&(r.readyState=1),1>r.networkState&&(r.networkState=2),i=!0,w[o]||(o="large"),r.videoHeight=w[o].height,r.videoWidth=w[o].width)}i&&e(t).trigger("durationchange").trigger("loadedmetadata"),setTimeout(u,9),1==n.data?(b("playing",r),a()):2==n.data?(clearInterval(r._timeInterval),b("pause",r)):3==n.data?(r.readyState>2&&(r.readyState=2),r.networkState=2,e(t).trigger("waiting")):0===n.data&&(r.readyState>4&&(r.readyState=4),r.networkState=1,clearInterval(r._timeInterval),e(t).trigger("ended"))}}}}),e(t).on("updateytdata",u)})};if("matchMedia"in n){var S=!1;try{S=n.matchMedia("only all").matches}catch(x){}S&&(s.sortMedia=function(e,t){return e=!e.media||matchMedia(e.media).matches,t=!t.media||matchMedia(t.media).matches,e==t?0:e?-1:1})}s.createSWF=function(n,r,u){u||(u=t.data(n,"mediaelement"));var a="yt-"+t.getID(n),f=m(r.src),c=e.prop(n,"controls");if(u)return s.setActive(n,"third",u),h(u),u.currentSrc=r.srcProp,c!=u._hasControls?(u.shadowElem.html('<div id="'+a+'">'),E(n,a,u,f)):o.done(function(){u._ytAPI.cueVideoByUrl&&u._ytAPI.cueVideoByUrl(f)}),u._hasControls=c,i;var p=e('<div class="polyfill-video polyfill-mediaelement" id="wrapper-'+a+'"><div id="'+a+'"></div>').css({position:"relative",overflow:"hidden"}),v=function(){d(u)};u=t.data(n,"mediaelement",t.objectCreate(l,{shadowElem:{value:p},_elem:{value:n},_hasControls:{value:c},currentSrc:{value:r.srcProp},buffered:{value:{start:function(e){return e>=u.buffered.length?(t.error("buffered index size error"),i):0},end:function(e){return e>=u.buffered.length?(t.error("buffered index size error"),i):u._buffered},length:0}}})),d(u),t.addShadowDom(n,p),s.setActive(n,"third",u),y(n),p.insertBefore(n),E(n,a,u,f),e(n).on("updatemediaelementdimensions loadedmetadata emptied",v).onWSOff("updateshadowdom",v)},function(){var n,r=function(t){clearTimeout(t.updateDataTimer),t.updateDataTimer=setTimeout(function(){e(t._elem).triggerHandler("updateytdata")},9)},s={},o=function(e){s[e]={get:function(){var t=v(this);return t?t[e]:n[e].prop._supget.apply(this)},writeable:!1}},u=function(e,t){o(e),delete s[e].writeable,s[e].set=t};a.forEach(o),u("currentTime",function(e){var t=v(this);return t?(e*=1,!isNaN(e)&&t._ytAPI&&t._ytAPI.seekTo&&(t._ytAPI.seekTo(e),r(t)),i):n.currentTime.prop._supset.apply(this,arguments)}),u("muted",function(e){var t=v(this);return t?(t._ytAPI&&t._ytAPI.mute&&(t._ytAPI[e?"mute":"unMute"](),r(t)),i):n.muted.prop._supset.apply(this,arguments)}),u("volume",function(e){var s=v(this);return s?(e*=100,!isNaN(e)&&s._ytAPI&&s._ytAPI.setVolume&&((0>e||e>100)&&t.error("volume greater or less than allowed "+e/100),s._ytAPI.setVolume(e),r(s)),i):n.volume.prop._supset.apply(this,arguments)}),e.each(["play","pause"],function(e,t){var r=t+"Video";s[t]={value:function(){var e=v(this);return e?(e._ytAPI&&e._ytAPI[r]&&(e._ytAPI[r](),b(t,e)),i):n[t].prop._supvalue.apply(this,arguments)}}}),n=t.defineNodeNameProperties("video",s,"prop"),t.onNodeNamesPropertyModify("video","controls",function(t,n){var r=v(this);e(this)[n?"addClass":"removeClass"]("webshims-controls"),r&&r._ytAPI&&!r.readyState&&e(this).mediaLoad()})}()});