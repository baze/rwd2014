(function(e){var t=function(e){return"number"==typeof e||e&&e==1*e},n=function(e,t){return"number"==typeof e||e&&e==1*e?1*e:t},r=["step","min","max","readonly","title","disabled","tabindex"],i={_create:function(){var t;for(this.element.addClass("ws-range").attr({role:"slider"}).append('<span class="ws-range-min" /><span class="ws-range-rail"><span class="ws-range-thumb" /></span>'),this.trail=e(".ws-range-rail",this.element),this.range=e(".ws-range-min",this.element),this.thumb=e(".ws-range-thumb",this.trail),this.updateMetrics(),this.orig=this.options.orig,t=0;r.length>t;t++)this[r[t]](this.options[r[t]]);this.value=this._value,this.value(this.options.value),this.initDataList(),this.element.data("rangeUi",this),this.addBindings(),this._init=!0},value:e.noop,_value:function(t,n,r){var i,s,o=this.options,u=t,a={},f={};n||parseFloat(t,10)==t||(t=o.min+(o.max-o.min)/2),n||(t=this.normalizeVal(t)),i=100*((t-o.min)/(o.max-o.min)),this._init&&t==o.value&&u==t||(this.options.value=t,this.thumb.stop(),this.range.stop(),f[this.dirs.width]=i+"%",this.vertical&&(i=Math.abs(i-100)),a[this.dirs.left]=i+"%",r?(r="object"!=typeof r?{}:e.extend({},r),r.duration||(s=Math.abs(i-parseInt(this.thumb[0].style[this.dirs.left]||50,10)),r.duration=Math.max(Math.min(999,5*s),99)),this.thumb.animate(a,r),this.range.animate(f,r)):(this.thumb.css(a),this.range.css(f)),this.orig&&(u!=t||!this._init&&this.orig.value!=t)&&this.options._change(t),this.element.attr({"aria-valuenow":this.options.value,"aria-valuetext":this.options.textValue?this.options.textValue(this.options.value):this.options.options[this.options.value]||this.options.value}))},initDataList:function(){if(this.orig){var t,n=this,r=function(){e(n.orig).jProp("list").off("updateDatalist",r).on("updateDatalist",r),clearTimeout(t),t=setTimeout(function(){n.list&&n.list()},9)};e(this.orig).on("listdatalistchange",r),this.list()}},list:function(){var n=this.options,r=n.min,i=n.max,s=this.trail,o=this;this.element.attr({"aria-valuetext":n.options[n.value]||n.value}),e(".ws-range-ticks",s).remove(),e(this.orig).jProp("list").find("option:not([disabled])").each(function(){n.options[e.prop(this,"value")]=e.prop(this,"label")||""}),e.each(n.options,function(u,f){if(!(!t(u)||r>u||u>i)){var l=100*((u-r)/(i-r)),c=n.showLabels&&f?' title="'+f+'"':"";o.vertical&&(l=Math.abs(l-100)),o.posCenter(e('<span class="ws-range-ticks"'+c+' data-label="'+f+'" style="'+o.dirs.left+": "+l+'%;" />').appendTo(s))}})},readonly:function(e){e=!!e,this.options.readonly=e,this.element.attr("aria-readonly",""+e),this._init&&this.updateMetrics()},disabled:function(e){e=!!e,this.options.disabled=e,e?this.element.attr({tabindex:-1,"aria-disabled":"true"}):this.element.attr({tabindex:this.options.tabindex,"aria-disabled":"false"}),this._init&&this.updateMetrics()},tabindex:function(e){this.options.tabindex=e,this.options.disabled||this.element.attr({tabindex:e})},title:function(e){this.element.prop("title",e)},min:function(e){this.options.min=n(e,0),this.value(this.options.value,!0)},max:function(e){this.options.max=n(e,100),this.value(this.options.value,!0)},step:function(e){var t=this.options,r="any"==e?"any":n(e,1);t.stepping&&("any"!=r&&t.stepping%r?webshims.error("wrong stepping value for type range:"+t.stepping%r):r=t.stepping),t.step=r,this.value(this.options.value)},normalizeVal:function(e){var t,n,r,i=this.options;return i.min>=e?e=i.min:e>=i.max?e=i.max:"any"!=i.step&&(r=i.step,t=(e-i.min)%r,n=e-t,2*Math.abs(t)>=r&&(n+=t>0?r:-r),e=1*n.toFixed(5)),e},doStep:function(e,t){var r=n(this.options.step,1);"any"==this.options.step&&(r=Math.min(r,(this.options.max-this.options.min)/10)),this.value(this.options.value+r*e,!1,t)},getStepedValueFromPos:function(e){var t,n,r,i;return 0>=e?t=this.options[this.dirs.min]:e>100?t=this.options[this.dirs.max]:(this.vertical&&(e=Math.abs(e-100)),t=(this.options.max-this.options.min)*(e/100)+this.options.min,i=this.options.step,"any"!=i&&(n=(t-this.options.min)%i,r=t-n,2*Math.abs(n)>=i&&(r+=n>0?i:-i),t=1*r.toFixed(5))),t},addRemoveClass:function(e,t){var n,r=-1!=this.element.prop("className").indexOf(e);!t&&r?(n="removeClass",this.element.removeClass(e),this.updateMetrics()):t&&!r&&(n="addClass"),n&&(this.element[n](e),this._init&&this.updateMetrics())},addBindings:function(){var t,n,r,i=this,s=this.options,o=function(){var t={};return{init:function(n,r,s){t[n]||(t[n]={fn:s},i.orig&&e(i.orig).on(n,function(){t[n].val=e.prop(i.orig,"value")})),t[n].val=r},call:function(e,n){t[e].val!=n&&(clearTimeout(t[e].timer),t[e].val=n,t[e].timer=setTimeout(function(){t[e].fn(n,i)},0))}}}(),u=function(e,r){var u=i.getStepedValueFromPos((e[i.dirs.mouse]-t)*n);u!=s.value&&(i.value(u,!1,r),o.call("input",u)),e&&"mousemove"==e.type&&e.preventDefault()},a=function(t){t&&"mouseup"==t.type&&(o.call("input",s.value),o.call("change",s.value)),i.addRemoveClass("ws-active"),e(document).off("mousemove",u).off("mouseup",a),e(window).off("blur",f)},f=function(e){e.target==window&&a()},l=function(r){var o;if(r.preventDefault(),e(document).off("mousemove",u).off("mouseup",a),e(window).off("blur",f),!s.readonly&&!s.disabled){if(i.element.focus(),i.addRemoveClass("ws-active",!0),t=i.element.focus().offset(),n=i.element[i.dirs.innerWidth](),!n||!t)return;o=i.thumb[i.dirs.outerWidth](),t=t[i.dirs.pos],n=100/n,u(r,s.animate),e(document).on({mouseup:a,mousemove:u}),e(window).on("blur",f),r.stopPropagation()}},c={mousedown:l,focus:function(){s.disabled||(o.init("input",s.value),o.init("change",s.value),i.addRemoveClass("ws-focus",!0),i.updateMetrics()),r=!0},blur:function(){i.element.removeClass("ws-focus ws-active"),i.updateMetrics(),r=!1,o.init("input",s.value),o.call("change",s.value)},keyup:function(){i.addRemoveClass("ws-active"),o.call("input",s.value),o.call("change",s.value)},keydown:function(e){var t=!0,n=e.keyCode;s.readonly||s.disabled||(39==n||38==n?i.doStep(1):37==n||40==n?i.doStep(-1):33==n?i.doStep(10,s.animate):34==n?i.doStep(-10,s.animate):36==n?i.value(i.options.max,!1,s.animate):35==n?i.value(i.options.min,!1,s.animate):t=!1,t&&(i.addRemoveClass("ws-active",!0),o.call("input",s.value),e.preventDefault()))}};o.init("input",s.value,this.options.input),o.init("change",s.value,this.options.change),c[e.fn.mwheelIntent?"mwheelIntent":"mousewheel"]=function(e,t){t&&r&&!s.readonly&&!s.disabled&&(i.doStep(t),e.preventDefault(),o.call("input",s.value))},this.element.on(c),this.thumb.on({mousedown:l}),window.webshims&&webshims.ready("WINDOWLOAD",function(){webshims.ready("dom-support",function(){e.fn.onWSOff&&i.element.onWSOff("updateshadowdom",function(){i.updateMetrics()})}),!e.fn.onWSOff&&webshims._polyfill&&webshims._polyfill(["dom-support"])})},posCenter:function(e,t){var n;!this.options.calcCenter||this._init&&!this.element[0].offsetWidth||(e||(e=this.thumb),t||(t=e[this.dirs.outerWidth]()),t/=-2,e.css(this.dirs.marginLeft,t),this.options.calcTrail&&e[0]==this.thumb[0]&&(n=this.element[this.dirs.innerHeight](),e.css(this.dirs.marginTop,(e[this.dirs.outerHeight]()-n)/-2),this.range.css(this.dirs.marginTop,(this.range[this.dirs.outerHeight]()-n)/-2),t*=-1,this.trail.css(this.dirs.left,t).css(this.dirs.right,t)))},updateMetrics:function(){var e=this.element.innerWidth();this.vertical=e&&this.element.innerHeight()-e>10,this.dirs=this.vertical?{mouse:"pageY",pos:"top",min:"max",max:"min",left:"top",right:"bottom",width:"height",innerWidth:"innerHeight",innerHeight:"innerWidth",outerWidth:"outerHeight",outerHeight:"outerWidth",marginTop:"marginLeft",marginLeft:"marginTop"}:{mouse:"pageX",pos:"left",min:"min",max:"max",left:"left",right:"right",width:"width",innerWidth:"innerWidth",innerHeight:"innerHeight",outerWidth:"outerWidth",outerHeight:"outerHeight",marginTop:"marginTop",marginLeft:"marginLeft"},this.element[this.vertical?"addClass":"removeClass"]("vertical-range")[this.vertical?"addClass":"removeClass"]("horizontal-range"),this.posCenter()}},s=function(e){function t(){}return t.prototype=e,new t};e.fn.rangeUI=function(t){return t=e.extend({readonly:!1,disabled:!1,tabindex:0,min:0,step:1,max:100,value:50,input:e.noop,change:e.noop,_change:e.noop,showLabels:!0,options:{},calcCenter:!0,calcTrail:!0},t),this.each(function(){var n=e.extend(s(i),{element:e(this)});n.options=t,n._create.call(n)})},window.webshims&&webshims.isReady&&(webshims.ready("es5",function(){webshims.isReady("range-ui",!0)}),webshims._polyfill&&webshims._polyfill(["es5"]))})(window.webshims?webshims.$:jQuery);